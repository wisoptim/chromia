module;
import balance.*;
import auth.*;

entity user {
  key pubkey; 
  key username: text;
}

operation create_user(token: session_token, username: text) {
  val pubkey = validate_session(token);
  require(pubkey, username != "");
  var new_user = create user (username);
  create balance (new_user, INITIAL_BALANCE); 
}

query get_user_by_username(username: text){
  return user @? {username};
}

